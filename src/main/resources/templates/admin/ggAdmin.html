<!DOCTYPE html>
<html  xmlns:th="http://www.thymeleaf.org" >
<head>
 	<th:block th:insert="~{admin/AdminLayout :: head}"/>
	<link rel="stylesheet" href="/css/member/commuteList.css">
	<th:block th:insert="~{admin/AdminLayout :: header}"/>

	<script type="text/javascript">
	$(function(){
		gotoworkcheck(goTime);
	});
	function gotoworkcheck(target){
		var time= $(target).text();
		var gotoworkcheck = time.substr(0, 2);
		var today = new Date();
		var todate = ('0' + today.getDate()).slice(-2);
		if(todate!=gotoworkcheck){
			$(".goTime").text("출근시간");
			$(".offTime").text("퇴근시간");
		}
	}
	//출근 버튼 누르면 출근시간 보여주고 db저장
	function btn_click(el){
		var type = $(el).text(); 
		var mno = $(".mno").val();
		var link = "go";
		if(type=="퇴근"){
			link = "off";
		}
		$.ajax({
			url:`/admin/commute/${link}/${mno}`,
			type:"post",
			success:function(text){
				//$(".commuteList").html(text);
				window.location.reload();
			},
			error:function(){
				alert("list비정상작동");
			}
		});
	
	}
	//퇴근 버튼 누르면 출근시간 수정시간 보여주고 db업데이트
	
	</script>

</head>
<body class="flex">
    <main>
    	<div class="wrap">
    		<input class="mno" type="hidden" th:value="${#authentication.principal.mno}">
    		<p>GreenGames의 관리페이지 입니다.</p>
    		<div class="flex"><!-- 네모네모 상자 -->
    			<div><!-- 출근 상자 -->
    				<button class="go" onclick="btn_click(this)">출근</button>
    			</div>
    			<div><!-- 퇴근 상자 -->
    				<button class="off" onclick="btn_click(this)">퇴근</button>
    			</div>
    		</div>
    	</div>
    	<div class="commute-wrap">
	    	<table>
				<thead class="commuteListHead">
					<tr class="head">
						<td>이름</td>
						<td>날짜</td>
						<td>출근시간</td>
						<td>퇴근시간</td>
						<td>근무형태</td>
					</tr>				
				</thead>
				<tbody class="commuteList">
					<tr class="body" th:each="lists : ${list}" th:if="${!#lists.isEmpty(list)}">
						<td th:text="${lists.name}">이름</td>
						<td th:text="${lists.today}">날짜</td>
						<td th:text="${lists.gTime}">출근시간</td>
					
						<td class="offTime2" th:if="${lists.oTime==lists.gTime}">퇴근시간</td>
						<td class="offTime2" th:text="${lists.oTime}" th:if="${lists.oTime!=lists.gTime}">퇴근시간</td>
					
						<td class="offTime3" th:text="${lists.cType}">근무형태</td>
					</tr>
					<tr th:if="${#lists.isEmpty(list)}">
						<td>값이 없습니다.</td>
					</tr>
					
					<div class="pageNumber" th:if="${p.getNumberOfElements()>0}">
						<a th:if="${p.hasPrevious()}" th:href="|/admin?page=${p.getNumber()}|">&lt;</a>
					
						<th:block th:each="p:${#numbers.sequence(startPage, endPage)}">
							<a th:if="${p != nowPage}" th:href="@{admin?(page=${p})}" th:text="${p}"></a>
							<a th:if="${p == nowPage}" th:text="${p}" class="active"></a>
						</th:block>
						<!-- th:href="@{notice-boards?(page=${p})}" -->
						<a th:if="${p.hasNext()}" th:href="|/admin?page=${p.getNumber()+2}|">&gt;</a>
					</div>
				</tbody>
			</table>
		</div>
    </main>
</body>
</html>